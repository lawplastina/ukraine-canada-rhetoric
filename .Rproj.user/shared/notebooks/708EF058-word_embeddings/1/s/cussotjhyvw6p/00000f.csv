"0","us_transcripts <- us_transcripts |> "
"0","  mutate("
"0","    trump_only = stringi::stri_trans_general(trump_only, ""Any-Latin; Latin-ASCII""),"
"0","    trump_only = replace_contraction(trump_only),"
"0","    trump_only = tolower(trump_only),"
"0","    trump_only = gsub(""[[:punct:]]+"", "" "", trump_only),"
"0","    trump_only = gsub(""\\s+"", "" "", trump_only)"
"0","  )"
"0",""
"0","tcm_trump <- us_transcripts$trump_only |> "
"0","  tokens() |> "
"0","  fcm(context = ""window"", window = 10) |> "
"0","  as(""dgCMatrix"")"
"2","Warning: NA is replaced by empty string"
"0","# Only keeping words with at least 30 co-occurrences (can maybe edit later?)"
"0","tcm_trump <- tcm_trump[colSums(tcm_trump) > 30, colSums(tcm_trump) > 30]"
"0",""
"0","weight_ppmi <- function(tcm) { ## fix zero self-occurrences "
"0","  diag(tcm) <- diag(tcm) + 1 ## weight by PMI "
"0","  tcm <- tcm %*% diag(1 / diag(tcm)) "
"0","  tcm <- log(tcm) ## positive PMI "
"0","  tcm[tcm < 0] <- 0 "
"0","  return(Matrix(tcm, sparse = TRUE)) }"
"0",""
"0","tcm_trump_ppmi <- weight_ppmi(tcm_trump)"
"0",""
"0","svd_tng_trump <- irlba(tcm_trump_ppmi, nv = 100)"
"0",""
"0","wv_tng_trump <- svd_tng_trump$v[, 1:100]"
"0","rownames(wv_tng_trump) <- rownames(tcm_trump_ppmi)"
